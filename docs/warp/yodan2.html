<HTML>
<HEAD><TITLE>YODAN of NYAOS</TITLE></HEAD>
<BODY bgcolor="#000000" text="#FFFFFF" link="#00FF00" vlink="#00AA00" alink = "#FF0000">

<CENTER>
<TABLE BORDER=10>
<TR><TD><FONT SIZE=+2>葉山文書</FONT><BR>7/26〜8/13の寝言篇</TD>
</TABLE>
</CENTER>
<UL>
  <li> <a href="yodan2.html#kaol">KAOL をベクターデザインにアップロードしました</a>(8/30)
  <li> <a href="yodan2.html#soscom">NYAOSの開発状況の報告はどうしたんだ！</a>(8/30)
  <li> <a href="yodan2.html#develop">開発環境</a>(8/30)
  <li> <a href="yodan2.html#rexx">REXX嫌い</a>(8/30)
  <li> <a href="yodan2.html#xfree86">XFree86</a>(8/28)
  <li> <a href="yodan2.html#ellbug">ELLの思わぬ問題、これはうかつだった！</a>(8/24)
  <li> <a href="yodan2.html#bug124">また、致命的バグ、すみません</a>(8/21)
  <li> <a href="yodan2.html#tvfs">TVFS導入</a>(8/19)
  <li> <a href="yodan2.html#longname">コメントとロングネーム</a>(8/16)
  <li> <a href="yodan2.html#titlelogo">タイトルをGIFにしました</a>(8/13)
</UL>

<img alt="▽" src="/www-mpe.cheme.kyoto-u.ac.jp_hayama/img/s11.gif"><a href="yodan.html">目次へ</a>
<hr>

<h3><a name="kaol">KAOL をベクターデザインにアップロードしました</a>(8/30)</h3>

って、タイトル通りです。OS/2 には less とか、PM用のページャとかが
あるから、そないに需要がないからと思って、今まで放っておいたのですが、
ELL のページャとして使える、標準入力からの入力を表示できるものが
less以外、あまり無いというお話を聞いて、開発から一年ほど過ぎた今になって
アップロードした次第です。(KAOL というネーミングは、
ちょっと DOS の MIEL を意識してます)
<P>
そういえば DOS風のコマンドラインツールが OS/2 には少ないですね。
OS/2はVDMが強力だから不要なのかもしれませんが、
やはり、HPFSのロングネームは使いたいし、この手のツールがもうちょっと必要ですね。
むしろ、この手のツールの方が emx/gccもあることだし、
作りやすいと思うのですが、なんで少ないんでしょうね?!
</P>
いつになるかは分かりませんが、個人的にはUNIX風のキーバインドを持った FD 風のツール、
ちょうと FDclone みたいなソフトを作ってみたいですね。
ただ、ネックは時間で<TT>...</TT>

<hr>
<h3><a name="soscom">NYAOSの開発状況の報告はどうしたんだ！</a>(8/30)</h3>

ここは本来、NYAOSの開発の進行状況を書くページのはずなんですが、
なにやら、OS/2 の不満・不平をぶつけるページになりつつあります。
チェックしてくださる方々、どうもすみません。
<P>
ええとですね、まず 1.24での落ちるバグはとれています。
そして、SOSスクリプトは SCRIPTPATH 上に置いておけば、
拡張子を書く・書かないに関わらず実行可能になりました。
これで、DOS・OS/2共用のスクリプトを書くことができます。
ただ、入力されたファイル名と、それに「<TT>.COM</TT>」を
末尾に追加した名前、それぞれについて、SCRIPTPATH を走査しているので、
ちょっと効率がよくありません。
<P>
これにあと、DOSVPATH を追加して、1.30 として公開しようと思っているのですが、
なかなか時間がとれず、先週くらいから、開発が停止してしまってます。
DOSVPATHについての仕様も固まっていないし、とりあえず、
これは放っておいて、1.25 として公開した方がよいでしょうかねぇ。
1.30 は xterm 対応を目玉にするため、まだおいときましょうか<TT>...</TT>
しかし、未だ XFree86 さえインストールしていないという<TT>...</TT>
ほんとにできんのかなぁ(と手を見る)

<hr>
<h3><a name="develop">開発環境</a>(8/30)</h3>

NYAOS は、基本的に emx/gcc だけで作っています。
で、他はな〜んもなし。
<P>
PMアプリを作るには、Visual Age C++ とかが必要なんでしょうが、
結構、値がはるし、プロやないんやから、趣味のプログラミングに
そこまで金をかけるのもね〜という意識もあって、
ちょっと買うつもりはありません（社会人になると考え変わるかも）。
<BLOCKQUOTE>
<FONT COLOR="#FF00FF">
（補足）<BR>
　emx でも PM アプリは作れるそうです。ううむ、思い込みはいかんなぁ<TT>...</TT>
</FONT>
</BLOCKQUOTE>
</P>
ですから、NYAOS というプログラムの性能は、基本的に emx/gcc の
ライブラリで制限されてしまうわけなんですよね。
ですから、どうしても出来ることと出来ないことがありそうで、ちとくやしい。
その点、PC-UNIX なんかは、開発環境が全てひっついてくるのがうらやましい。
でも、XFree86 for OS/2 なら、emx だけで Ｘウインドウアプリが作れるかな？
<P>
まぁ、それはそうと、OS/2 は フリーソフトが少ないですね。
舶来ものは一見多いように見えて、ほとんどはシェアウェアだったりするし、
コンソール系のやつは、AXの呪いで、罫線が全てカナに化けて、
みっともないのが多いです。一度、AFONT で、カナのところを全て罫線に置きかえた
fontxフォントにしたことがありますが、WPS 内で半角カナを使って
いるところが思ったより多かったので、結局やめました。
<P>
日本のフリーソフトは、多くの作者が「OS/2を広めねば」という
志を持っているのかどうかは知りませんが、シェアウェア率は
低いようです。しかし、絶対数が少ないのが、いかんともしがたい<TT>...</TT>
Pack for Win を読む限りでは、Windows版ならば同じような
ツールでも必ず2,3個存在していたりするんですよね。
まぁ、JAVAもいいですけど、OS/2 を普及させたいんだったら、
開発ツールを安くすることが必要ではないでしょうかねぇ。
<P>
ところで、emx のバージョンはいつになったら、「0.9」から「1.0」
になるんでしょう？
</P>
<HR>
<h3><a name="rexx">REXX嫌い</a>(8/30)</h3>
<P>
OS/2 のセールスポイントとして、みなさん、よく REXX をお勧めになるんですが、
僕は REXX がどうもうまく使えない人間なんです<TT>(;_;)</TT>
理由として次のような点があります。
<ul>
  <li> 文法がことごとく、UNIX 系と違っている。
       極めつけは行の継続記号をカンマとしている。
       バックスラッシュにしろとは言わないが、
       カンマでは パラメータの区切りのカンマとややこしくて仕方が無い。
       
  <li> inf 形式のマニュアルが読みにくい。
       <TT>view.exe</TT>も使いづらい。
       頼むから画面いっぱいにウインドウを広げるのはやめてくれ。
       紙のマニュアルは売ってるけど、高い。

  <li> 似たような機能が複数の手段で提供されていて、ごちゃごちゃしている。
       汎用的な一関数を用意してくれればそれで済むのに<TT>...</TT>
       
  <li> ちょっとした用事は、使い慣れた perl で済んでしまう。
       文字列操作系は DLL を利用すればよいようだが、
       そこまでする気になれない。
</ul>
いろいろけなしましたが、REXX というのは、良きにつけ、悪しにつけ、
BASICみたいな言語だと思います。
<BR>
　あと、文法にも不可解な点が多いんですよ。
多重分岐というのは、C言語のswitch〜caseのように
式の値に対して、該当する値を持った case ラベルに分岐するように
作るものですが、REXXのそれ(select〜whenだっけ？)は、
条件を数並べたもので、単にIF文にELSE IF をたくさん並べたものと変わりません。
DO〜END も中括弧に対応させているのだと思いますが、これも IF文で使うとき、
ちょっと見苦しく感じます。まだ、Fortran の方がましって感じです。
<BR>
　僕の感覚っておかしいでしょうか？
<BR>
<BLOCKQUOTE>
<FONT COLOR="#FF00FF">
（補足）<BR>
　書き殴ってから、その後、ちょっと反省しました。
まぁ、僕は Perl とか C言語に毒されすぎなんでしょうね。
上で書いたことは、かなり偏見入ってると思います（笑）。
<BR>
　いや、使いこなせれば、ものすげー便利な言語に違いないと思うんです。
その言語一つで、ノーマルなREXX以外にも、Dr.Dialog とかも使えるように
なるでしょうし、PC-DOS 7 でも利用できますし。
しかし、使い易い（安い!?）リファレンスマニュアルが無いもんで、
つい、いらついて投げ出してしまうんで<nobr>す。<enbr><TT>(;_;)</TT></nobr>
<BR>
　やはり、言語一つをマスターするならば、
ちゃんとしたマニュアルを買わねばいけないかなぁ<TT>...</TT>
それなりにお金をかければ、元を取り返さねばと一生懸命になるんですけどね。
</FONT>
</BLOCKQUOTE>

<hr>
<h3><a name="xfree86">XFree86</a>(8/28)</h3>

XFree86 の xterm 上で、NYAOS が動かないようです。
<P>
まぁ、普通、OS/2 ネイティブのソフトが、そのまま xterm で動く
なんていうことは無いだろうから、あたりまえと思うのですが、
NYAOS では極力移植性を考えて、
<TT>v_****</TT>系のVIO関数の使用を控え、できるだけ printf と
BACKSPACE などに押さえていただけに、「あとちょっと、何かが
足りない、惜しい」という心境です。
<P>
実際のところ、タイトルの表示に <TT>ESC[2J ESC[1H</TT> などを実は使っていました。
この他、color-ls や prompt の $I でもエスケープシーケンスを使っていますが、
<PRE>
      alias ls=&quot;ls -o&quot;
      option -vio
</PRE>
などで、抑制できるはずです。しかし、画面表示が原因ではなさそうな雰囲気。
<P>
僕自身は、まだ XFree86 をインストールしていないので、
何とも言えないのですが、あるＸに詳しい方によると（筑波の宇野さんです<TT>(^_^;</TT>）、
どうもキーボード関係で凍っているのではないかとのこと。
単純に read_kbd 関数を使っているのですが、これがどうもまずい模様。
<P>
しかし、何はともあれ、XFree86 の xterm 上で動かすと公言した以上、
XFree86 をまずはインストールしなければ。
だ、だが、時間が<TT>....</TT>。今、秋季大会の用意で、
三日ほど、大学に泊り続けているのですよ。誰か助けてくれぇ<TT>...</TT>
（今日、帰りますけどね<TT>^^;</TT>）

<hr>
<h3><a name="ellbug">ELL の思わぬ問題、これはうかつだった！</a>(8/24)</h3>

ELL というプログラムは、書庫の内部になる、書庫を参照することができます。
これは書庫を解凍してから、再帰的に自分を呼び出しているからなんですが、
どうも、環境変数PATH に ELL のあるディレクトリがないと、起動に失敗するようです。
<P>
おそらく、ソースで<CODE>system(&quot;ELL ...&quot;)</CODE>って感じで、
自分自身を呼び出していたと思うのですが、
絶対パスで起動すると機能が利用できないというのもおかしいし、
これではバッチファイルから使用することもできないので、
ちゃんと自分自身の絶対パス名を取得して、それを使って起動するように
したいと思います。
<P>
あと、ELL の tips になりますが、標準入力に対応していないページャーは、
ell.prm の最後に「<CODE>!*;エディタ名</CODE>」と
いう行を追加すれば、(たぶん)利用可能となります。
ただし、<KBD><img alt="[RETURN]" src="/www-mpe.cheme.kyoto-u.ac.jp_hayama/img/cr.gif"></KBD>キーで
起動する場合で、「<KBD>v</KBD>」では駄目です。


<HR>
<h3><a name="bug124">また、致命的バグ、すみません</a>(8/21)</h3>

とほほ。また、致命的バグを出してしまいました。
<P>
展開順序を入れかえた時に、書き込むバッファを入れかえるのを忘れるという...
だから、スクリプトを実行したり、「&amp;」を末尾に書いたり、
「&amp;&amp;」などを使うと、NYAOS が落ちてしまいます。
</P>
また、機能を追加して、うかれてしまって、十分なチェックを怠ってしまいました。
とほほ。いつまでたっても安定版にならないなぁ...
<P>
ちなみに、今、手元のバージョンでは、1.24のデバグは済んでいるのですが、
思いきった機能拡張に踏み切ってしまって、公開するにできない状況になってしまいました。
人の迷惑省みずですね。まぁ、その前の 1.23 も 公開したのが 10日くらい前なので、
まぁ、当分 1.23 で我慢していただくということで、お許しくださいませ。
<P>
（一応、一ヶ月に一回をバージョンアップのペースにしているつもりですが、
化学工学会秋季大会の準備や、後期試験(^^;)で忙しくなるので、
次の 1.25(もしかしたら、1.30)は、だいぶと後になりそうです）

<HR>
<h3><a name="tvfs">TVFS導入</a>(8/19)</h3>

OS/2 mag.の特集で取り上げられていた、TVFS を導入しました。
<P>
この TVFS、以前にも使ったことがあったのですが、その時は
ファイルのシンボリックリンクが主に欲しかったので、
リンクの数に上限のある(といっても100以上はあると思うが)TVFSは
ちょっとなーと、その時は敬遠しました(使い方も悪かったし、勘違いしていました)。
<P>
最近になって、HDを増設したのはいいんですが、PureDOS と OS/2 で
ドライブ文字が違って混乱するような状況になりまして、
ディレクトリのリンクを自由に張れるという点で TVFS が必要になりました。
<P>
久しぶりにインストールしてみると、どうも TVSAVE がハングしたりするんで、
一度、使用をあきらめていました。
そこへ OS/2 mag. が特集をしてくれて、設定すべき、オプションが分かりました。
<PRE>
    tvctl -Dw
</PRE>
しかし、推奨の設定は普通、オプション無しのデフォルトにするよなぁ。
<P>
TVFS.INF をよく読まなかった言い訳になりますが、
VIEW.EXE って使いづらいんですよね。
画面いっぱいにウインドウを開いてしまって、
マニュアルを見ながら作業するっていうのが非常にしにくい。
いったい、IBMは何を考えているんだか。
しかも、強調も(ハイパー)リンクも同じように青い文字を使うし。
はっきり言って、INF形式なんぞ廃止してしまって、ヘルプも何も
全て html で供給して、ブラウザで見るようにした方が、よっぽどいいと思う。
<P>
結局、e:\startup.cmd に次のように設定しました。
<PRE>
    tctrl -Dw
    tvmount z:
    tvlink -rw z:\usr e:\usr
    tvlink -rw z:\pool i:\pool
    tvlink -r  z:\bin e:\usr\bin
</PRE>
できれば、フロッピー(a:)や、CD-ROM(j:) とか ZipDrive(k:) とかも
<PRE>
    tvlink -n -d -rw z:\floppy a:\
    tvlink -n -d -r  z:\cdrom  j:\
    tvlink -n -d -rw z:\zip    k:\
</PRE>
とリンクできたらいいんですけどね。
それぞれ、メディアを入れている時でないと、リンク張れないみたいです。
volcheck.cmd とか eject.cmd とかを用意するという方法もありますが...ね。

<HR>
<H3><a name="longname">コメントとロングネーム</a>(しつこい)(8/16)</h3>

カレントディレクトリ以外のディレクトリに対する eadir で コメントやロングネーム
(WPS上での名前)が全く表示されないバグがあったので、修正しました。
<P>
ついでに、今までコメントやロングネームが低輝度の白(灰)で表示されていて、
あるのか、ないのか分からないので、この際、コメントは青地に白、ロングネームは
赤字に白という目立つ色で表示されるようにしました。まぁ、これは趣味も
あると思うので、
LS_COLORS に新たに「cm」と「ln」という項を追加して、カスタム可能にしました。
<BR>(なるべく早く公開します)
<P>
こうやって、eadir を改良すると、いつも、ついやってしまいたくなるのが、ディレ
クトリやアーカイブにメモをつけまくることですが、内蔵コマンドの comment
とか eadir とかは、ちょっと打ちにくい。そこで、
<PRE>
    alias ll=&quot;eadir %*&quot;
    alias memo=&quot;comment %*&quot;
</PRE>
という2行を自分の ~/.nyaos に追加しました。
<P>
しかし、せっかくコメントとかを簡単に書き込めても、テキストファイルの拡張属性
は簡単にエディターに消されてしまうのが、悲しすぎるますな(我ながら、しつこい)。
<P>
唯一、拡張属性を維持してくれる 奥村版 jstevie は、
初期設定ファイルとしてカレントディレクトリの./stevie.rcしか読んでくれない
ようで、失望(これは stevie 自身の特徴かもしれないが<TT>...</TT>)。
~/stevie.rc や%EXINIT%も読んでほしかった。
<P>
やはり、UNIX から移植されたプログラムは拡張属性に冷たいなぁ。

<HR>
<h3><a name="titlelogo">タイトルをGIFにしました</a></h3>

こんなことしている暇ないんだけどなー（笑）。
タイトルをGIF画像にしました。基本的に
<PRE>
]]  ]] ]]  ]]  ]]]]   ]]]]   ]]]]]  
]]] ]] ]]  ]] ]]  ]] ]]  ]] ]]    ] 
]]]]]]  ]]]]  ]]]]]] ]]  ]]   ]]]   
]] ]]]   ]]   ]]  ]] ]]  ]] ]    ]] 
]]  ]]   ]]   ]]  ]]  ]]]]   ]]]]]
</PRE>
というタイトルロゴの非空白部分を
単に<img alt="単一の赤い丸のGIF画像" src="/www-mpe.cheme.kyoto-u.ac.jp_hayama/img/dot_red.gif">
に置きかえただけです。
<ol>
  <li> JavaScript
  <li> Perl で、鬼のような&lt;td&gt;&lt;img src=&quot;dot_red.gif&quot;&gt;&lt;/td&gt;の山を吐き出させる。
  <li> 一枚板 gif ファイル
</ol>
と考えて結局、単純な一枚板 GIF にしてしまいました。
あと、履歴を別のファイルにして、最新バージョンの特徴だけを
ホームページの頭に移動しました。
<HR>
<img alt="▽" src="/www-mpe.cheme.kyoto-u.ac.jp_hayama/img/s11.gif"><a href="yodan1.html">さらに過去の余談へ</a>
</body>
</html>
